# Установка

## Требования и зависимости

Для данных языковых средств требуется установленная LuNA, зависимости для неё, а также:

- GNU Flex & Bison
- Python 3+
- Pyinstaller (for Python)

Команды установки зависимостей для дистрибутива Ubuntu

```bash
# Update apt-get
$ sudo apt update

# Python
$ sudo apt install python3

# Pyinstaller
$ pip install pyinstaller

# GNU Flex & Bison
$ sudo apt install flex bison
```

Для проверки установленных зависимостей, необходимо выполнить в терминале следующие команды: 
```bash
$ which python3 # Или python --version 
$ which flex 
$ which bison  
```

## Сборка исполняемых файлов из исходников


Клонируем [репозиторий](https://github.com/brusN/luna-bundle-prog-generator) и переходим в директорию с ним

```bash
$ git clone https://github.com/brusN/luna-bundle-prog-generator
$ cd luna-bundle-prog-generator
```
Запускаем сборку исполняемых файлов через make

```bash
$ make
```


## Добавление собраных исполняемых файлов в PATH

После успешной сборки языковых средств, необходимо добавить папку bin данного репозитория в PATH: 

```bash
# Добавить данный кусок кода, например, в ~/.bashrc
# Например, export LUNA_BUNDLE_HOME=/home/brusn/Repositories/luna-bundle-prog-generator
$ export LUNA_BUNDLE_HOME=*path_to_luna_bundle_repository*/bin
$ export PATH=$LUNA_BUNDLE_HOME/bin:$PATH
```

Для проверки доступности языковых средств, необходимо выполнить в терминале следующие команды: 
```bash
$ which luna-bundle-parser  
$ which luna-mpi-generator 
```

# Теория

## Прямое управление исполнением программы. Понятие свертки.

Данные языковые средства были разработаны с целью предоставления возможности прямого управления исполнением фрагментированных программ в системе LuNA. 

Прямое управление исполнением параллельных программ подразумевает собой возможность вручную задать распределение ресурсов на вычислительные узлы, определить порядок исполнения блоков кода и на каких узлах распределенной вычислительной системы их исполнять. Такая заданая конфигурация исполнения называется **сверткой**. 

Таким образом, программист, описав правильную свертку, в теории может повысить эффективность исполнения программы в системе LuNA.

## Функциональность

На данный момент языковые средства обладают следующей функциональностью:
- Определение фрагмента данных
- Пересылка фрагмента данных между узлами	
- Исполнение фрагмента вычислений на определенном узле

В процессе разработки данный список будет изменяться и пополняться.

## Структура файла описания свертки

Файл имеет расширение `.bndl` и имеет свой синтаксис. Свертка содержит два главных блока — блок макроопределний и блок исполнения.

```
# Блок макроопределений
define {
    ...
}

# Блок исполнения
execution {
    ...
}
```

В **блоке макроопределений** описываются текстовые макроконстанты, их можно использовать для параметризации и в дальнейшем использовать в блоке исполнения.

В **блоке исполнения** последовательно описываются операторы управления исполнением программы. Они представляют собой базовые действия, которые в совокупности составляют функциональность языковых средств. Порядок описания операторов задает порядок исполнения программы. 

>**Примечание.** На данный момент синтаксический анализатор свертки требует, чтобы объявлялись оба блока вне зависимости от их содержимого, и блок макроопределений обязательно должен быть первым. См. структуру файла свертки. 

## Операторы управления исполнением программы

### Оператор run

...

### Оператор send

...

### Оператор define

...


# Пример

Файл свертки

```
# bundle.bndl

define {
    N = 4;
}

execution {
    
}
```